export const posts = [{"excerpt":"","title":"åœ¨Next.jsåšå®¢ä¸­æ·»åŠ RSSæ”¯æŒ","content":"\nç°åœ¨ä½¿ç”¨ RSS è®¢é˜…çš„äººè¶Šæ¥è¶Šå°‘äº†ï¼Œä½†æ˜¯å¯¹æˆ‘è€Œè¨€ï¼Œåœ¨ä¿¡æ¯è¿‡å‰©çš„æ—¶ä»£é€šè¿‡ RSS è¿‡æ»¤ä¸ç›¸å¹²çš„æ¨èä¿¡æ¯æ˜¯ä¿æŒé«˜æ•ˆè·å–ä¿¡æ¯çš„å¿…è¦æ‰‹æ®µã€‚\næœ¬æ–‡æˆ‘ä¼šä»‹ç»å¦‚ä½•åœ¨åšå®¢ä¸­æ·»åŠ  RSS è®¢é˜…åŠŸèƒ½\n\n## RSS æ˜¯ä»€ä¹ˆ\n\n> RSS(Really Simple Syndication)æ˜¯ä¸€ç§æè¿°å’ŒåŒæ­¥ç½‘ç«™å†…å®¹çš„æ ¼å¼ï¼Œå…¶ä¸­åŒ…å«æ¥è‡ªç½‘ç«™çš„æ›´æ–°æ‘˜è¦ï¼Œé€šå¸¸é‡‡ç”¨å¸¦æœ‰é“¾æ¥çš„æ–‡ç« åˆ—è¡¨çš„å½¢å¼ã€‚\n\n## ä¸ºåšå®¢æ·»åŠ  RSS åŠŸèƒ½\n\nä¸ºä¸ªäººåšå®¢æ·»åŠ  RSS æ”¯æŒéœ€è¦ç”¨åˆ°ä¸€ä¸ªåŒååŒ…\n\n```shell\npnpm add rss -D\n```\n\næ¥ç€ï¼Œåˆ›å»ºä¸€ä¸ª RSS å¯¹è±¡ï¼Œé‡Œé¢åŒ…å«äº†ä½ åšå®¢çš„æ ‡é¢˜ï¼Œæè¿°ï¼Œurl ç­‰ä¿¡æ¯\n\n```typescript\nconst feed = new RSS({\n  title: \"Tsuizen's blog\",\n  description: 'éšä¾¿å†™ä¸œè¥¿çš„åœ°æ–¹',\n  site_url: siteUrl,\n  feed_url: `${siteUrl}/feed.xml`,\n  language: 'cn',\n  pubDate: new Date(),\n  copyright: `All rights reserved ${new Date().getFullYear()}, Tsuizen`\n});\n```\n\nå…¨éƒ¨å±æ€§å¯å‚è€ƒ[RSS channel å±æ€§](https://www.runoob.com/rss/rss-channel.html)\n\nç„¶åéå†æ‰€æœ‰çš„æ–‡ç« å¹¶æ·»åŠ æ–‡ç« ä¿¡æ¯\n\n```typescript\nallPosts.map((post) => {\n  feed.item({\n    title: post.title,\n    url: `${siteUrl}/posts/${post.title}`,\n    date: post.date,\n    description: post.description\n  });\n});\n```\n\nå¯ä»¥æ·»åŠ çš„ä¿¡æ¯è¯·å‚è€ƒ[RSS item å…ƒç´ ](https://www.runoob.com/rss/rss-item.html)\n\næœ€åå°†å…¶å†™å…¥ public ç›®å½•å³å¯ï¼Œå®Œæ•´ä»£ç å¦‚ä¸‹\n\n```typescript\nimport { writeFileSync } from 'fs';\nimport RSS from 'rss';\n\nimport { Post } from '@/types';\n\nimport { getRecentPosts } from './posts';\n\ntype RSSPost = Pick<Post, 'title' | 'createdAt' | 'description'> & {\n  date: Date;\n  url: string;\n};\n\nconst getRSS = async () => {\n  const siteUrl = process.env.SITE_URL;\n  const allPosts = await getRecentPosts<RSSPost>([\n    'title',\n    'createdAt',\n    'description'\n  ]);\n\n  const feed = new RSS({\n    title: \"Tsuizen's blog\",\n    description: 'éšä¾¿å†™ä¸œè¥¿çš„åœ°æ–¹',\n    site_url: siteUrl,\n    feed_url: `${siteUrl}/feed.xml`,\n    language: 'cn',\n    pubDate: new Date(),\n    copyright: `All rights reserved ${new Date().getFullYear()}, Tsuizen`\n  });\n\n  allPosts.map((post) => {\n    feed.item({\n      title: post.title,\n      url: `${siteUrl}/posts/${post.title}`,\n      date: post.date,\n      description: post.description\n    });\n  });\n\n  writeFileSync('./public/feed.xml', feed.xml({ indent: true }));\n};\n\nexport default getRSS;\n```\n\nè¦è®©åšå®¢èƒ½å¤ŸåŠæ—¶æ›´æ–° xml æ–‡ä»¶ï¼Œè¿˜éœ€è¦åœ¨ `page/index.tsx` ä¸­çš„ `getStaticProps` æ·»åŠ æ‰§è¡Œè¯­å¥ï¼Œ\n\n```typescript\nexport async function getStaticProps() {\n  ...\n\n  await getRSS();\n\n  ...\n}\n```\n\nç°åœ¨è®¿é—®é¦–é¡µåå°±å¯ä»¥çœ‹è§ public ç›®å½•ä¸­ç”Ÿæˆäº† `feed.xml`ï¼Œç”¨æˆ·è®¿é—®`/feed.xml`å°±å¯ä»¥è®¢é˜… RSS äº†\n","slug":"add-rss-in-nextjs","tags":["RSS","Next.js"],"draft":false},{"excerpt":"","title":"ä¸ºåšå®¢æ·»åŠ SEOä¼˜åŒ–ä»¥åŠç«™ç‚¹åœ°å›¾","content":"\n## ä¸ºåšå®¢æ·»åŠ  SEO å’Œç«™ç‚¹åœ°å›¾\n\nSEO çš„å­¦é—®éå¸¸å¤šï¼Œæœ¬åšå®¢å°½å¯èƒ½è´´è¿‘è°·æ­ŒæŒ‡å¯¼çš„è§„èŒƒå¯¹ seo è¿›è¡Œé…ç½®ã€‚\n\nåœ¨ next.js é¡¹ç›®ä¸­æ·»åŠ  seo ä¸€èˆ¬ä½¿ç”¨`next-seo`ç¬¬ä¸‰æ–¹åº“ã€‚è¦åœ¨å…¨éƒ¨é¡µé¢é…ç½®é»˜è®¤ SEO éœ€è¦åœ¨`_app.tsx`æ–‡ä»¶ä¸­å¼•å…¥`DefaultSeo`ç»„ä»¶ã€‚\n\n```tsx\nexport default function App() {\n\n// ...\n\n  const SEO = {\n    defaultTitle: \"Tsuizen's blog\",\n    titleTemplate: \"%s | Tsuizen's blog\",\n    description: 'Tsuizençš„ä¸ªäººåšå®¢',\n    canonical: \"https://blog.tsuizen.cn\",\n    robotsProps: {\n      noarchive: false, // ä¸æ˜¾ç¤ºç¼“å­˜é“¾æ¥\n      nosnippet: false, // ä¸åœ¨æœç´¢ä¸­æ˜¾ç¤ºæ–‡æœ¬ç‰‡æ®µ\n      maxSnippet: -1, // å€¼ä¸º-1è°·æ­Œä¼šæ˜¾ç¤ºä»–è®¤ä¸ºæœ€æœ‰æ•ˆçš„æ–‡æœ¬ç‰‡æ®µé•¿åº¦\n      notranslate: false, // ä¸åœ¨æœç´¢ç»“æœä¸­æä¾›é¡µé¢ç¿»è¯‘\n      noimageindex: false // ä¸è¦åœ¨æ­¤é¡µé¢ä¸Šä¸ºå›¾åƒç¼–åˆ¶ç´¢å¼•ã€‚å¦‚æœä¸æŒ‡å®šæ­¤å€¼ï¼Œé¡µé¢ä¸Šçš„å›¾åƒå¯èƒ½ä¼šè¢«ç¼–å…¥ç´¢å¼•å¹¶æ˜¾ç¤ºåœ¨æœç´¢ç»“æœä¸­ã€‚\n    }\n  };\n\n  return {\n    <DefaultSeo {...SEO} />\n  }\n}\n```\n\nä»¥ä¸Šæ˜¯æˆ‘é€‰æ‹©çš„é»˜è®¤è®¾ç½®ï¼Œ`titleTemplate`ä¸­çš„ %s æ˜¯æ¯ä¸ªé¡µé¢å•ç‹¬è®¾ç½®çš„æ ‡é¢˜å†…å®¹ï¼Œè¿™æ ·æ‰€æœ‰çš„é¡µé¢å°±é»˜è®¤ä¼šæºå¸¦ %s\nåé¢çš„æ¨¡æ¿ã€‚å…¶ä»–çš„é…ç½®å¯ä»¥å‚è€ƒ`next-seo`çš„[æ–‡æ¡£](https://github.com/garmeeh/next-seo)\n\næ¥ç€æ¥å•ç‹¬é…ç½®æ¯ä¸ªé¡µé¢çš„å†…å®¹ï¼Œéœ€è¦åœ¨ç›¸åº”é¡µé¢å¼•å…¥`NextSEO`ç»„ä»¶ï¼Œä»¥ post é¡µä¸ºä¾‹åœ¨`NextSEO`ç»„ä»¶ä¸­æ·»åŠ å¯¹åº”çš„å†…å®¹å³å¯ï¼Œ\næƒ³è¦åœ¨ç¤¾äº¤ç½‘ç«™åˆ†äº«æ—¶å‘ˆç°ä¸é”™çš„æ•ˆæœå°±éœ€è¦å¯¹ openGraph è¿›è¡Œé…ç½®\n\n```tsx\n<NextSeo\n  {...SEO}\n  title={post.title}\n  description={post.description}\n  canonical={'https://blog.tsuizen.cn/' + post.title}\n  openGraph={{\n    title: `${post.title}`,\n    description: `${post.description}`,\n    url: 'https://blog.tsuizen.cn/posts/' + post.title,\n    type: 'article',\n    article: {\n      publishedTime: post.createdAt,\n      modifiedTime: post.updatedAt,\n      authors: ['Tsuizen'],\n      tags: post.tags\n    },\n    images: []\n  }}\n/>\n```\n\n## ç»“æ„åŒ–æ•°æ® JSON-LD\n\næˆ‘ä»¬è¿˜å¯ä»¥åœ¨ç½‘é¡µä¸­æ·»åŠ ç»“æ„åŒ–æ•°æ®è®©è°·æ­Œè¯»å–ï¼Œé’ˆå¯¹ä¸åŒçš„ç½‘é¡µç±»å‹ä½œä¸åŒçš„æœç´¢ç»“æœå‘ˆç°ã€‚\nåœ¨åšå®¢é¡µé¢ï¼Œæˆ‘æ·»åŠ äº†ä¸€ä¸ª Article çš„ç»“æ„åŒ–æ•°æ®ç”¨æ¥æè¿°æ–‡ç« ä¿¡æ¯\n\n<Youtube videoId=\"vioCbTo3C-4\" />\n\n```tsx\n<ArticleJsonLd\n  url={`https://blog.tsuizen.cn/posts/${post.title}`}\n  title={post.title}\n  images={[]}\n  datePublished={post.createdAt}\n  dateModified={post.updatedAt}\n  authorName={[\n    {\n      name: 'Tsuizen',\n      url: 'https://blog.tsuizen.cn'\n    }\n  ]}\n  publisherName=\"Tsuizen\"\n  publisherLogo=\"https://blog.tsuizen.cn/images/logo.png\"\n  description={post.description}\n  isAccessibleForFree={true}\n/>\n```\n\nåœ¨ç½‘é¡µä¸­ä¼šè¢«å±•å¼€æˆå¦‚ä¸‹å½¢å¼:\n\n```html\n<script type=\"application/ld+json\">\n  {\n    \"@context\": \"https://schema.org\",\n    \"@type\": \"Article\",\n    \"datePublished\": \"2023-01-18T00:00:00.000Z\",\n    \"description\": \"èº«ä¸ºç å†œæ€ä¹ˆèƒ½æ²¡æœ‰è‡ªå·±çš„åšå®¢ï¼Œç”±äºåšå®¢å›­çš„æ•´æ”¹é£æ³¢ï¼Œå‡ºäºå®‰å…¨åŸå› å†³å®šè‡ªå·±æ­å»ºï¼Œé¡ºä¾¿å¯ä»¥ç»ƒä¹ æŠ€æœ¯ä»¥åŠç£ä¿ƒè‡ªå·±æ›´æ–°ğŸ§ã€‚\",\n    \"mainEntityOfPage\": {\n      \"@type\": \"WebPage\",\n      \"@id\": \"https://blog.tsuizen.cn/posts/ä½¿ç”¨Next.jsæ„å»ºæˆ‘çš„ä¸ªäººåšå®¢\"\n    },\n    \"headline\": \"ä½¿ç”¨Next.jsæ„å»ºæˆ‘çš„ä¸ªäººåšå®¢\",\n    \"image\": [],\n    \"dateModified\": \"2023-01-18T00:00:00.000Z\",\n    \"author\": [\n      { \"@type\": \"Person\", \"name\": \"Tsuizen\", \"url\": \"https://blog.tsuizen.cn\" }\n    ],\n    \"publisher\": {\n      \"@type\": \"Organization\",\n      \"name\": \"Tsuizen\",\n      \"logo\": {\n        \"@type\": \"ImageObject\",\n        \"url\": \"https://blog.tsuizen.cn/images/logo.png\"\n      }\n    },\n    \"isAccessibleForFree\": true\n  }\n</script>\n```\n\nè¿™æ ·è°·æ­Œå°±èƒ½æ ¹æ®ä½ çš„éœ€è¦å±•ç¤ºæ›´ä¸°å¯Œçš„æœç´¢ç»“æœã€‚\n\n## ç«™ç‚¹åœ°å›¾\n\næœ€åå†æ¥è¯´è¯´ç«™ç‚¹åœ°å›¾çš„é—®é¢˜ï¼Œè¿™æ˜¯è°·æ­Œå®˜æ–¹ç»™å‡ºçš„å®šä¹‰ï¼š\n\n> ç«™ç‚¹åœ°å›¾æ˜¯ä¸€ç§æ–‡ä»¶ï¼Œæ‚¨å¯ä»¥åœ¨å…¶ä¸­æä¾›ä¸æ‚¨ç½‘ç«™ä¸­çš„ç½‘é¡µã€è§†é¢‘æˆ–å…¶ä»–æ–‡ä»¶æœ‰å…³çš„ä¿¡æ¯ï¼Œè¿˜å¯ä»¥è¯´æ˜è¿™äº›å†…å®¹ä¹‹é—´çš„å…³ç³»ã€‚Google ç­‰æœç´¢å¼•æ“ä¼šè¯»å–æ­¤æ–‡ä»¶ï¼Œä»¥ä¾¿æ›´é«˜æ•ˆåœ°æŠ“å–æ‚¨çš„ç½‘ç«™ã€‚ç«™ç‚¹åœ°å›¾ä¼šå‘Šè¯‰ Google æ‚¨è®¤ä¸ºç½‘ç«™ä¸­çš„å“ªäº›ç½‘é¡µå’Œæ–‡ä»¶æ¯”è¾ƒé‡è¦ï¼Œè¿˜ä¼šæä¾›ä¸è¿™äº›æ–‡ä»¶æœ‰å…³çš„é‡è¦ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼Œç½‘é¡µä¸Šæ¬¡æ›´æ–°çš„æ—¶é—´å’Œç½‘é¡µæ˜¯å¦æœ‰ä»»ä½•å¤‡ç”¨çš„è¯­è¨€ç‰ˆæœ¬ã€‚\n\næˆ‘ä»¬å¯ä»¥ä½¿ç”¨`next-sitemap`æ¥ç”Ÿæˆç«™ç‚¹åœ°å›¾\n\né¦–å…ˆåœ¨æ ¹ç›®å½•åˆ›å»ºé…ç½®æ–‡ä»¶`next-sitemap.config.js`ï¼Œæ·»åŠ åœ°å€ï¼Œæ›´æ–°é¢‘ç‡ç­‰éœ€è¦çš„å±æ€§ï¼Œç„¶åæ ¹æ®éœ€è¦å¯ä»¥åœ¨ `transform` å‡½æ•°ä¸­é…ç½®ä¸åŒç›¸å¯¹è·¯å¾„ä¸­çš„å±æ€§\nï¼Œè¿™é‡Œæˆ‘ä¿®æ”¹äº†ä¸åŒé¡µé¢å¯¹åº”çš„ä¼˜å…ˆçº§ï¼Œæ›´å¤šçš„å±æ€§ç”¨æ³•å¯ä»¥å‚è€ƒ[å®˜æ–¹æ–‡æ¡£](https://github.com/iamvishnusankar/next-sitemap)\n\n```javascript\n/** @type {import('next-sitemap').IConfig} */\n\nmodule.exports = {\n  siteUrl: 'https://blog.tsuizen.cn',\n  changefreq: 'daily',\n  priority: 1,\n  sitemapSize: 5000,\n  generateRobotsTxt: true,\n  // exclude: ['/protected-page', '/awesome/secret-page'],\n  // alternateRefs: [\n  //   {\n  //     href: 'https://blog.tsuizen.cn',\n  //     hreflang: 'cn'\n  //   }\n  // ],\n  // Default transformation function\n  transform: async (config, path) => {\n    const result = {\n      loc: 'https://blog.tsuizen.cn' + path, // => this will be exported as http(s)://<config.siteUrl>/<path>\n      changefreq: config.changefreq,\n      priority: config.priority,\n      lastmod: config.autoLastmod ? new Date().toISOString() : undefined,\n      alternateRefs: config.alternateRefs ?? []\n    };\n    if (path.startsWith('/tag')) {\n      result.priority = 0.6;\n    }\n    if (path.startsWith('/posts')) {\n      result.priority = 1;\n      this.changefreq = 'always';\n    }\n    if (path.startsWith('/category')) {\n      result.priority = 0.4;\n    }\n    if (path.startsWith('/archives')) {\n      result.priority = 0.3;\n    }\n    return result;\n  },\n  // additionalPaths: async (config) => [\n  //   await config.transform(config, '/additional-page')\n  // ],\n  robotsTxtOptions: {\n    policies: [\n      {\n        userAgent: '*',\n        allow: '/'\n      },\n      {\n        userAgent: 'test-bot',\n        allow: ['/path', '/path-2']\n      }\n      // {\n      //   userAgent: 'black-listed-bot',\n      //   disallow: ['/sub-path-1', '/path-2']\n      // }\n    ],\n    additionalSitemaps: []\n  }\n};\n```\n\næœ€ååœ¨`package.json`ä¸­å¯ä»¥åœ¨ `postbuild` å‘¨æœŸé…ç½®æ‰§è¡Œè„šæœ¬\n\n```json\n\"postbuild\": \"next-sitemap\",\n```\n\nç„¶åæˆ‘ä»¬å°±èƒ½çœ‹åˆ° public ä¸‹ç”Ÿæˆäº†å¯¹åº”çš„ç«™ç‚¹ xml æ–‡ä»¶å’Œ robots.txt\n","slug":"add-seo-sitemap","tags":["Next.js","SEO"],"draft":false},{"excerpt":"","title":"è¿˜åœ¨ä½¿ç”¨ä¼ ç»Ÿå›¾ç‰‡æ‡’åŠ è½½ï¼Ÿ","content":"\n## æ¦‚è¿°\n\nå›¾ç‰‡æ‡’åŠ è½½æ˜¯æ¯ä¸€ä¸ªå‰ç«¯ç»•ä¸è¿‡çš„è¯é¢˜ï¼Œåœ¨ç”¨æˆ·è®¿é—®é¡µé¢æ—¶ï¼Œå¦‚æœä¸€æ¬¡æ€§åŠ è½½æ‰€æœ‰å›¾ç‰‡ä¼šæå¤§åœ°å½±å“ç”¨æˆ·ä½“éªŒã€‚å›¾ç‰‡æ‡’åŠ è½½å°±æ˜¯è®©æµè§ˆå™¨åªè¯·æ±‚å‡ºç°åœ¨å¯è§†åŒºåŸŸä¸­çš„å›¾ç‰‡ã€‚\nä¼ ç»Ÿå›¾ç‰‡æ‡’åŠ è½½æ–¹å¼æœ‰ä¸¤ç§ï¼š\n\n- ç›‘å¬ scroll äº‹ä»¶\n- IntersectionObserver API\n\nç¬¬ä¸€ç§æ–¹å¼é€šè¿‡ç›‘å¬ `scroll` äº‹ä»¶åˆ¤æ–­å›¾ç‰‡æ˜¯å¦å‡ºç°åœ¨å¯è§†åŒºåŸŸä¸­ï¼Œç„¶åæ›¿æ¢ src å±æ€§ã€‚è™½ç„¶è¿™ç§æ–¹å¼çš„å…¼å®¹æ€§è¾ƒå¥½ï¼Œä½†æ˜¯ `scroll`\näº‹ä»¶è¿è¡Œåœ¨ä¸»çº¿ç¨‹å¹¶ä¸”è§¦å‘é¢‘ç¹ï¼Œéœ€è¦å†å†™ä¸€ä¸ªèŠ‚æµå‡½æ•°ï¼Œéå¸¸ä¸ä¼˜é›…ã€‚\n\nç¬¬äºŒç§æ–¹å¼ä½¿ç”¨ `IntersectionObserver` API ç›‘å¬é¡µé¢å…ƒç´ çš„å¯è§æ€§ï¼Œæ˜¯ç›®å‰æœ€ä¸ºæ¨èçš„ä¸€ç§æ–¹å¼ã€‚`IntersectionObserver` æ›´æ–¹ä¾¿ä½¿ç”¨å¹¶ä¸”å…·æœ‰æ›´å¥½çš„å¯è¯»æ€§ï¼Œ\næˆ‘ä»¬åªéœ€è¦è€ƒè™‘ç¼–å†™å…ƒç´ å¯è§æ—¶éœ€è¦æ‰§è¡Œçš„ä»£ç å³å¯ï¼Œä¸»æµæµè§ˆå™¨ä¹Ÿå·²ç»åŸºæœ¬æ”¯æŒã€‚\n![IntersectionObserverå…¼å®¹æ€§](/images/posts-images/image-lazy-loading/IntersectionObserverå…¼å®¹æ€§.jpg)\n\n## æµè§ˆå™¨çº§åˆ«çš„æ‡’åŠ è½½\n\næ—¢ç„¶æœ‰äº† `IntersectionObserver` ä¸ºä»€ä¹ˆè¿˜éœ€è¦æµè§ˆå™¨çº§åˆ«çš„æ‡’åŠ è½½æ”¯æŒï¼ŒChrome å›¢é˜Ÿç»™å‡ºçš„åŸå› æœ‰ä¸¤ä¸ªï¼š\n\n1. ä¸å†éœ€è¦å¼•å…¥å¤–éƒ¨å·¥å…·æˆ–è€…åº“\n2. æµè§ˆå™¨ç¦æ­¢ JavaScript ä¹Ÿèƒ½æ­£å¸¸å·¥ä½œ\n\nä½†æ˜¯ç¬¬äºŒç‚¹ MDN ç»™å‡ºä¸åŒçš„æ„è§ï¼š\n\n:::warning\nå¤‡æ³¨ï¼š ä»…åœ¨å¯ç”¨ JavaScript æ—¶æ‰ä¼šå»¶è¿ŸåŠ è½½ã€‚è¿™æ˜¯ä¸€ç§åè·Ÿè¸ªçš„æªæ–½ï¼Œå› ä¸ºï¼Œå¦‚æœç”¨æˆ·ä»£ç†åœ¨ç¦ç”¨è„šæœ¬çš„æƒ…å†µä¸‹æ”¯æŒå»¶è¿ŸåŠ è½½ï¼Œç½‘ç«™ä»ç„¶è·¨æºé€šè¿‡åœ¨å›¾åƒä¸­ç­–ç•¥æ€§åœ°æ”¾ç½®å›¾åƒæ¥è·Ÿè¸ªç”¨æˆ·åœ¨æ•´ä¸ªä¼šè¯æœŸé—´çš„å¤§è‡´æ»šåŠ¨ä½ç½®ï¼Œè¿™æ ·æœåŠ¡å™¨å¯ä»¥è·Ÿè¸ªè¯·æ±‚äº†å¤šå°‘å›¾åƒä»¥åŠè¯·æ±‚åœ¨ä½•æ—¶å‘èµ·ã€‚\n:::\n\nç»è¿‡å®é™…æµ‹è¯•ï¼Œåœ¨åœç”¨ javascript æ—¶ä¸ä¼šå¼€å¯æ‡’åŠ è½½ã€‚\n\n### ä½¿ç”¨æ–¹æ³•\n\nä½¿ç”¨æ–¹æ³•éå¸¸ç®€å•ï¼Œåªéœ€è¦åœ¨ img æ ‡ç­¾ä¸­æ·»åŠ ä¸€ä¸ª loading å±æ€§å³å¯ã€‚\n\n```html\n<img src=\"image.png\" loading=\"lazy\" alt=\"â€¦\" width=\"200\" height=\"200\" />\n```\n\nloading çš„å±æ€§å€¼æœ‰ä¸¤ä¸ªï¼š\n\n- lazy: å›¾ç‰‡æ‡’åŠ è½½\n- eager: å›¾ç‰‡æ­£å¸¸åŠ è½½\n\n:::tip\nä½¿ç”¨ eager çš„å›¾ç‰‡ç›¸æ¯”ä¸ä½¿ç”¨ loading å±æ€§çš„ img æ ‡ç­¾å¹¶ä¸ä¼šè·å¾—æ›´é«˜çš„åŠ è½½ä¼˜å…ˆçº§ï¼Œæ‰€ä»¥æ­£å¸¸åŠ è½½çš„å›¾ç‰‡æ— éœ€æ·»åŠ æ­¤å±æ€§ã€‚\n:::\n\n### æ•ˆæœ\n\n#### Chrome\n\nä¸ºäº†è®©å›¾ç‰‡åœ¨è¿›å…¥è§†å£æ—¶æœ€å¤§é™åº¦åœ°åŠ è½½å®Œæˆï¼Œä½¿ç”¨ lazy å±æ€§çš„å›¾ç‰‡ä¼šåœ¨åˆ°è¾¾å®ƒé™„è¿‘çš„ä¸€ä¸ªä½ç½®æ—¶å°±å¼€å§‹è¯·æ±‚ï¼Œchrome ä¸­çš„è¯·æ±‚è¿‡ç¨‹å¦‚ä¸‹ï¼š\n\n![chrome](/images/posts-images/image-lazy-loading/chrome.gif)\n\nå¯ä»¥çœ‹åˆ°åœ¨é¦–æ¬¡åŠ è½½æ—¶è¯·æ±‚äº† 5 å¼ å›¾ç‰‡ï¼Œä¸‹æ‹‰è¿‡ç¨‹ä¸­åˆ°å¯¹åº”å›¾ç‰‡çš„è·ç¦»åˆ°è¾¾ä¸€ä¸ªé˜ˆå€¼æ—¶å°±å·²ç»å¼€å§‹è¯·æ±‚ã€‚\n\né¡µé¢åœ¨åˆ·æ–°æ—¶ä¼šè®°ä½åˆ·æ–°å‰çš„ä½ç½®ï¼Œæµè§ˆå™¨ä¹Ÿå¾ˆæ™ºèƒ½åœ°è¯·æ±‚è¿™ä¸ªä½ç½®é™„è¿‘é˜ˆå€¼èŒƒå›´å†…çš„å›¾ç‰‡ï¼š\n![chrome-diff-loc](/images/posts-images/image-lazy-loading/chrome-diff-loc.gif)\n\nå¦ä¸€ä¸ªé‡è¦çš„ç‰¹æ€§æ˜¯æµè§ˆå™¨ä¼šæ ¹æ®ç½‘ç»œæ¡ä»¶æ”¹å˜é˜ˆå€¼èŒƒå›´ï¼Œç½‘é€Ÿè¶Šæ…¢ï¼Œé˜ˆå€¼è¶Šé«˜ã€‚åœ¨é«˜é€Ÿ 3G æ¡ä»¶ä¸‹ï¼Œchrome é¦–æ¬¡åŠ è½½äº† 7 å¼ å›¾ç‰‡ï¼š\n![chrome-3g](/images/posts-images/image-lazy-loading/chrome-3g.gif)\n\n> On fast connections (4G), we reduced Chrome's distance-from-viewport thresholds from 3000px to 1250px and on slower connections (3G or lower), changed the threshold from 4000px to 2500px. \n\næ ¹æ® chrome å¼€å‘è€…çš„è¯´æ³•ï¼Œåœ¨ 4G æ¡ä»¶ä¸‹é˜ˆå€¼å¤§å°ä¸º 1250pxï¼Œè€Œåœ¨ 3G æˆ–è€…æ›´ä½æ—¶è¿™ä¸ªå€¼ä¸º 2500px\n\n:::warning\nå€¼çš„æ³¨æ„çš„æ˜¯ï¼š\n\n1. å„ä¸ªæµè§ˆå™¨å‚å•†å¯¹é˜ˆå€¼å¤§å°æœ‰ä¸åŒçš„å®ç°å¹¶å¯èƒ½ä¼šåœ¨æœªæ¥æ›´æ”¹ã€‚åœ¨æµ‹è¯•ä¸­ Safari å’Œ Firefox çš„é˜ˆå€¼éƒ½æ¯” chrome è¦å°ï¼Œè€Œä¸”æ²¡æœ‰è€ƒè™‘åˆ°ä¸åŒçš„ç½‘ç»œæ¡ä»¶ã€‚\n2. é˜ˆå€¼å¤§å°æ˜¯ç¡¬ç¼–ç çš„ï¼Œå¼€å‘è€…ç›®å‰ä¸èƒ½è‡ªå®šä¹‰ã€‚\n   :::\n\n#### Firefox\n\n![firefox](/images/posts-images/image-lazy-loading/firefox.gif)\n\n#### Safari\n\n![safari](/images/posts-images/image-lazy-loading/safari.gif)\n\n### å…¼å®¹æ€§\n\næœ¬æ–‡æµ‹è¯•å¹³å°:\n\nchrome 109.0.5414.119ï¼ˆæ­£å¼ç‰ˆæœ¬ï¼‰ (arm64)\n\nfirefox 109.0(64 ä½)\n\nsafari 16.3 (18614.4.6.1.5)\n\n![å…¼å®¹æ€§](/images/posts-images/image-lazy-loading/å…¼å®¹æ€§.jpeg)\n\n## å‚è€ƒèµ„æ–™\n\nhttps://web.dev/browser-level-image-lazy-loading/\n","slug":"image-lazy-loading","tags":["å‰ç«¯æ€§èƒ½ä¼˜åŒ–","HTML"],"draft":false}]